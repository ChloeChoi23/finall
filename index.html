<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ê¸°ì–µìœ¼ë¡œ ê¹¨ì–´ë‚˜ëŠ” ìŠµì§€</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'Shilla';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2206-02@1.0/Shilla_CultureB-Bold.woff2') format('woff2');
            font-weight: 700;
            font-display: swap;
        }
        *{margin:0;padding:0;box-sizing:border-box;}
        html,body{
            height:100%;
            overflow:hidden;
            background:#0c1913;
            font-family:'Noto Sans KR',sans-serif;
            color:#dfe8e3;
        }
        #bg{
            position:fixed;
            inset:0;
            z-index:0;
            pointer-events:none;
            background: linear-gradient(rgba(10,20,15,0.6),rgba(5,10,8,0.8)), url('ì´ë¯¸ì§€ 2025. 11. 12. 00.58.jpeg') center/cover no-repeat;
            filter:brightness(0.6) saturate(0.9);
            opacity:1;
            transition:opacity 2s ease, filter 3s ease, background 3s ease;
        }
        #bg.next{
            background: linear-gradient(rgba(5,8,6,0.3),rgba(0,0,0,0.6)), url('wetland_subtle_fast.gif') center/cover no-repeat;
            filter:brightness(0.9) contrast(1.05);
        }
        canvas{
            position:absolute;
            inset:0;
            z-index:1;
            width:100%;
            height:100%;
            display:block;
        }
        #statsIntro{
            position:absolute;
            inset:0;
            background:rgba(10,20,15,0.75);
            backdrop-filter:blur(5px);
            z-index:5;
            display:flex;
            flex-direction:column;
            justify-content:center;
            align-items:center;
            opacity:1;
            transition:opacity 1.6s ease;
        }
        #statsIntro.hide{opacity:0; pointer-events:none;}
        .stats-title{
            font-family:'Shilla';
            font-size:clamp(32px,4.5vw,64px);
            color:#ecfff3;
            margin-bottom:40px;
            opacity:0;
            transform:translateY(20px);
            transition:opacity 1s ease, transform 1.2s ease;
        }
        .stats-title.show{opacity:1; transform:translateY(0);}
        .stats-table{
            width:70%;
            max-width:650px;
            border-collapse:collapse;
            font-size:clamp(16px,1.6vw,20px);
            opacity:0;
            transform:translateY(20px);
            transition:opacity 1.2s ease, transform 1.2s ease;
        }
        .stats-table.show{opacity:1; transform:translateY(0);}
        .stats-table tr{border-bottom:1px solid rgba(255,255,255,0.12);}
        .stats-table td{padding:16px 10px;}
        .value{text-align:right; font-weight:600; color:#c7ffe0;}
        .counter{opacity:0; transition:opacity .35s ease;}
        .counter.show{opacity:1;}
        .counter.red{color:#ff3a3a!important;}
        @keyframes dropIn {
            0%{transform:translateY(-60px);opacity:0;}
            60%{transform:translateY(0);opacity:1;}
            75%{transform:translateY(-12px);}
            100%{transform:translateY(0);}
        }
        .counter.drop{animation:dropIn .85s ease-out forwards;}
        #alertFlash{
            position:fixed;
            inset:0;
            background:rgba(255,0,0,0.65);
            z-index:6;
            opacity:0;
            transition:opacity .4s ease;
            pointer-events:none;
        }
        #alertFlash.show{opacity:1;}
        .center-text{
            position:absolute;
            top:50%;
            left:50%;
            transform:translate(-50%,-50%);
            width:90%;
            text-align:center;
            opacity:0;
            transition:opacity 1.8s ease;
            z-index:3;
        }
        .center-text.show{opacity:1;}
        .subtitle{
            position:absolute;
            top:-22vh;
            width:100%;
            font-size:clamp(16px,1.8vw,22px);
            white-space:pre-line;
            opacity:0;
            transform:translateY(12px);
            transition:opacity 1.3s ease, transform 1.3s ease;
        }
        .subtitle.show{opacity:1; transform:translateY(0);}
        .title{
            font-family:'Shilla';
            font-size:clamp(40px,6.3vw,82px);
            opacity:0;
            transition:opacity 1s ease;
        }
        .title.show{opacity:1;}
        .main-title{
            margin-top:3vh;
            font-family:'Shilla';
            font-size:clamp(72px,12vw,150px);
            color:rgba(255,255,255,0.65);
            opacity:0;
            transform:translateY(20px);
            transition:opacity 2.2s ease, transform 2.2s ease;
        }
        .main-title.show{opacity:1; transform:translateY(0);}
        .enter-btn{
            position:fixed;
            left:50%;
            bottom:6vh;
            transform:translateX(-50%);
            padding:0.8rem 2.4rem;
            font-family:'Shilla';
            font-size:1.1rem;
            color:#eaf5eb;
            background:rgba(255,255,255,0.1);
            border-radius:999px;
            border:none;
            cursor:pointer;
            opacity:0;
            transition:opacity 1.2s ease;
            z-index:5;
        }
        .enter-btn.show{opacity:1;}
        .fade-out{opacity:0!important; pointer-events:none!important;}
        .name{
            position:absolute;
            z-index:4;
            color:white;
            font-family:'Shilla';
            font-size:1.4rem;
            opacity:0;
            transform:translate(-50%,-50%) scale(0.8);
            transition:opacity .4s ease, transform 1.3s ease;
            pointer-events:none;
        }
        .name.show{opacity:1; transform:translate(-50%,-50%) scale(1.05);}
        .creature{
            position:fixed;
            z-index:2;
            opacity:0.35;
            filter:blur(1px) contrast(0.8);
            transition:opacity .8s ease, filter .8s ease, transform .8s ease;
            animation:floatSoft 12s ease-in-out infinite alternate;
            pointer-events:auto;
        }
        .creature.hide{
            opacity:0;
            filter:blur(4px) contrast(0.5);
        }
        .creature.gone{
            display:none;
        }
        .creature:hover{
            opacity:1;
            filter:blur(0) contrast(1);
        }
        @keyframes floatSoft{
            0%{transform:translate3d(0,0,0);}
            25%{transform:translate3d(20px,-15px,0);}
            50%{transform:translate3d(-18px,12px,0);}
            75%{transform:translate3d(15px,18px,0);}
            100%{transform:translate3d(-15px,-12px,0);}
        }
        #creature1{ bottom:10%; left:40%; width:13vw; animation-duration:15s; }
        #creature2{ top:16%; right:32%; width:12vw; animation-duration:13s; }
        #creature3{ top:58%; right:6%; width:26vw; animation-duration:14s; }
        #creature4{ top:50%; left:10%; width:13vw; animation-duration:12s; }
        #creature5{ top:28%; left:7%; width:19vw; animation-duration:16s; }
        #creature6{ top:17%; right:9%; width:10vw; animation-duration:15s; }
        #creature7{ bottom:30%; left:34%; width:15vw; animation-duration:18s; }
        #creature8{ top:24%; right:20%; width:16vw; animation-duration:17s; }
        #creature9{ top:18%; right:12%; width:11vw; animation-duration:14s; }
        #creature10{bottom:18%; right:32%; width:14vw; animation-duration:12s; }
        #creature11{bottom:42%; left:24%; width:11vw; animation-duration:13s; }
        #mouseGuide{
            position:fixed;
            top:50%;
            left:50%;
            transform:translate(-50%,-50%);
            font-size:1.8rem;
            color:white;
            font-family:'Shilla';
            opacity:0;
            transition:opacity 1.5s ease;
            z-index:30;
        }
        #mouseGuide.show{opacity:1;}
        #mouseGuide.hide{opacity:0;}
        #infoBox{
            position:absolute;
            width:20vw;
            background:rgba(5,15,12,0.92);
            border:1px solid rgba(160,255,210,0.85);
            box-shadow:0 0 24px rgba(0,255,210,0.35);
            padding:18px 22px;
            display:none;
            color:#ccffdd;
            font-family:'Noto Sans KR',sans-serif;
            z-index:999999 !important;
        }
        #infoBox .box-title{
            font-family:'Shilla';
            font-size:1.4rem;
            margin-bottom:6px;
            letter-spacing:0.03em;
        }
        #infoBox .box-img{
            width:100%;
            margin:8px 0 10px;
            filter:contrast(1.05);
            display:block;
        }
        #infoBox .box-desc{
            font-size:0.8rem;
            line-height:1.5;white-space: pre-line;
        }
        .line{
            position:absolute;
            height:2px;
            background:rgba(255,50,50,0.8);
            transform-origin:left center;
            z-index:2000;
        }
        .point{
            position:absolute;
            width:14px;
            height:14px;
            background:#5df97a;
            border-radius:50%;
            border:2px solid #55ff77;
            z-index:5000;
        }
        .point-label{
            position:absolute;
            font-family:'Shilla';
            font-size:14px;
            color:#5df97a;
            transform:translate(-50%,-50%);
        }
        .infoBox-close{
            position:absolute;
            top:6px;
            right:10px;
            font-size:18px;
            cursor:pointer;
            color:#99ffcc;
        }
        .shape-overlay{
            position:fixed;
            display:none;
            pointer-events:none;
            z-index:3000;
            width:100%;
            height:100%;
            object-fit:contain;
        }
        .shape-overlay.show{
            display:block;
        }
        #fullFadeBlack, #fullFadeAfter {
            position:fixed;
            inset:0;
            z-index:999999999;
            pointer-events:none;
            opacity:0;
}
       #fullFadeBlack {
        background:#000;
        transition:opacity 1.6s ease; 
}

       #fullFadeAfter {
        background:url('after.jpg') center/cover no-repeat;
        transition:opacity 2.4s ease;   
}


        #endingCards {
            display:flex;
            gap:32px;
            overflow-x:auto;
            padding:40px 80px 60px;
            width:100%;
            max-width:1800px;
            opacity:0;
            transform:translateY(40px);
            transition:opacity 1.5s ease, transform 1.5s ease;
            scroll-behavior:smooth;
        }
        #endingCards::-webkit-scrollbar {
            display:none;
        }

        #endingCards .card {
            width:460px;
            background:#0b0f0e;
            border-radius:20px;
            padding:22px;
            color:white;
            flex-shrink:0;
            border:1px solid rgba(160,255,210,0.85); 
            box-shadow:0 0 24px rgba(0,255,210,0.35);
            transition:0.35s ease;
}

        #endingCards .card .imgWrap {
            width:100%;
            height:240px; 
            border-radius:14px;
            background:#000;
            display:flex;
            justify-content:center;
            align-items:center;
            overflow:hidden;
            margin-bottom:14px;
        }
        #endingCards .card img {
            width:100%;
            height:100%;
            object-fit:contain;
            filter:drop-shadow(0 0 4px rgba(93,249,122,0.45));
        }
        #endingCards .card h3{
            font-family:'Shilla';
            font-size:1.4rem;
            margin-bottom:4px;
        }
        #endingCards .card p{
            font-size:0.9rem;
            opacity:0.85;
            line-height:1.45;
        }
        #endingCards .card:hover {
            transform:translateY(-10px);
            border:1px solid rgba(160,255,210,1);
            box-shadow:0 0 24px rgba(0,255,210,0.85), 0 0 40px rgba(0,255,210,0.45);
}

        .shape-overlay.show{
            display:block;
            pointer-events:none !important;
        }
        #endingScreen{
            justify-content: center;
            align-items: center;
            flex-direction: column;
            text-align: center;
}
         #endingTitle,
         #endingMessage,
         #endingSub{
            text-align: center;
            margin-left: 0;
            margin-right: 0;
}


    </style>
</head>
<body tabindex="-1">
    <video id="bgm" src="forestsound.mp3" autoplay loop playsinline style="display:none"></video>
    <audio id="touchSound" src="touch.mp3" preload="auto"></audio>
    <audio id="afterSound" src="after.webm" preload="auto"></audio>

    <div id="bg"></div>
    <canvas id="ripples"></canvas>
    <canvas id="lines"></canvas>
    <div id="alertFlash"></div>

    <div id="mouseGuide">ë§ˆìš°ìŠ¤ë¥¼ í´ë¦­í•´ ìƒë¬¼ë“¤ì„ ê¹¨ì›Œì£¼ì„¸ìš”.</div>

    <div id="statsIntro">
        <div class="stats-title" id="statsTitle">í•œêµ­ ìŠµì§€, ì‚¬ë¼ì§€ëŠ” ìˆ«ìë“¤</div>
        <table class="stats-table" id="statsTable">
            <tr><td>ë‚´ë¥™ ìŠµì§€ ì†Œì‹¤</td><td class="value"><span class="counter" data-val="176">0</span>ê³³</td></tr>
            <tr><td>ì—°ì•ˆ ìŠµì§€ ê°ì†Œ</td><td class="value"><span class="counter" data-val="5.2">0</span>ã¢</td></tr>
            <tr><td>ìŠµì§€ë³´í˜¸ì§€ì—­</td><td class="value"><span class="counter" data-val="58">0</span>ê°œì†Œ</td></tr>
            <tr><td>ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼</td><td class="value"><span class="counter" data-val="282">0</span>ì¢…</td></tr>
        </table>
    </div>

    <div class="center-text" id="intro">
        <div class="subtitle" id="subtitle"></div>
        <div class="title" id="title"></div>
        <div class="main-title" id="mainTitle">í™”í¬ì²œ</div>
    </div>

    <img src="a.png" id="creature1" class="creature gone" alt="">
    <img src="b.png" id="creature2" class="creature gone" alt="">
    <img src="c.png" id="creature3" class="creature gone" alt="">
    <img src="d.png" id="creature4" class="creature gone" alt="">
    <img src="e.png" id="creature5" class="creature gone" alt="">
    <img src="f.png" id="creature6" class="creature gone" alt="">
    <img src="g.png" id="creature7" class="creature gone" alt="">
    <img src="h.png" id="creature8" class="creature gone" alt="">
    <img src="i.png" id="creature9" class="creature gone" alt="">
    <img src="j.png" id="creature10" class="creature gone" alt="">
    <img src="k.png" id="creature11" class="creature gone" alt="">

    <img src="a1.png" id="overlay-creature1" class="shape-overlay">
    <img src="b1.png" id="overlay-creature2" class="shape-overlay">
    <img src="c1.png" id="overlay-creature3" class="shape-overlay">
    <img src="d1.png" id="overlay-creature4" class="shape-overlay">
    <img src="e1.png" id="overlay-creature5" class="shape-overlay">
    <img src="f1.png" id="overlay-creature6" class="shape-overlay">
    <img src="g1.png" id="overlay-creature7" class="shape-overlay">
    <img src="h1.png" id="overlay-creature8" class="shape-overlay">
    <img src="i1.png" id="overlay-creature9" class="shape-overlay">
    <img src="j1.png" id="overlay-creature10" class="shape-overlay">
    <img src="k1.png" id="overlay-creature11" class="shape-overlay">

    <button id="enterBtn" class="enter-btn">ENTER</button>

    <div id="infoBox">
        <div class="infoBox-close">Ã—</div>
        <div class="box-title"></div>
        <img class="box-img" alt="">
        <div class="box-desc"></div>
    </div>
<script>
    let overlayShownCount = 0;
    let autoRippleInterval = null;

    function updateGuideMessage() {
    const guide = document.getElementById("clickGuide");

    if (awakenedCount === 0) {
        guide.textContent = "ìƒë¬¼ì„ í´ë¦­í•´ë³´ì„¸ìš”.";
    } 
    else if (awakenedCount === 1) {
        guide.textContent = "ì¢‹ì•„ìš”! ìƒë¬¼ë“¤ì´ ê¹¨ì–´ë‚˜ê³  ìˆì–´ìš”.";
    } 
    else if (awakenedCount === 3) {
        guide.textContent = "ê³„ì† ì°¾ì•„ì£¼ì„¸ìš”. ì´ê³³ì€ ë‹¹ì‹ ì˜ ê¸°ì–µìœ¼ë¡œ ì‚´ì•„ë‚©ë‹ˆë‹¤.";
    } 
    else if (awakenedCount === 5) {
        guide.textContent = "ì ˆë°˜ì„ ì°¾ì•˜ì–´ìš”. ìŠµì§€ì˜ ìƒëª…ì´ ê¹¨ì–´ë‚˜ê³  ìˆìŠµë‹ˆë‹¤.";
    } 
    else if (awakenedCount === 8) {
        guide.textContent = "ê±°ì˜ ë‹¤ ì°¾ì•˜ì–´ìš”. ì¡°ê¸ˆë§Œ ë”!";
    }
    else if (awakenedCount === totalCreatures) {
        guide.textContent = "ëª¨ë“  ìƒë¬¼ë“¤ì´ ê¹¨ì–´ë‚¬ìŠµë‹ˆë‹¤.";
    }
}



function playClickSound() {
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = "square";
    osc.frequency.value = 1000;
    gain.gain.setValueAtTime(0.15, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.08);
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.08);
}

const bgm=document.getElementById("bgm");
bgm.volume=0.05;
bgm.play().catch(()=>{
    const resume=()=>{
        bgm.play();
        document.removeEventListener("click",resume);
        document.removeEventListener("keydown",resume);
    };
    document.addEventListener("click",resume);
    document.addEventListener("keydown",resume);
});

function increaseVolume(){
    let v=0.05;
    const id=setInterval(()=>{
        v+=0.02;
        bgm.volume=v;
        if(v>=0.6) clearInterval(id);
    },150);
}

const touchSound = document.getElementById("touchSound");
const creatures = Array.from(document.querySelectorAll('.creature'));
let awakenedCount = 0;
const totalCreatures = creatures.length;
const counterUI = document.getElementById("progressCounter");

const canvas=document.getElementById('ripples'), ctx=canvas.getContext('2d');
let W=canvas.width=innerWidth, H=canvas.height=innerHeight;
window.addEventListener('resize',()=>{
    W=canvas.width=innerWidth;
    H=canvas.height=innerHeight;
});

let ripples=[], allowNames=false;

document.addEventListener('mousemove', e=>{
    ripples.push({x:e.clientX,y:e.clientY,radius:0,alpha:1,speed:3.2});
    if(allowNames) createFloatingName(e.clientX,e.clientY);
});
function autoRipples(){
    const x = Math.random() * W;
    const y = Math.random() * H;

    ripples.push({
        x: x,
        y: y,
        radius: 0,
        alpha: 1,
        speed: 2.5
    });
}
function draw(){
    ctx.clearRect(0,0,W,H);
    ripples.forEach((r,i)=>{
        ctx.beginPath();
        ctx.arc(r.x,r.y,r.radius,0,Math.PI*2);
        ctx.strokeStyle=`rgba(200,255,225,${r.alpha*0.55})`;
        ctx.lineWidth=2;
        ctx.stroke();

        r.radius+=r.speed;
        r.alpha*=0.965;
        if(r.alpha<0.02) ripples.splice(i,1);
    });
    requestAnimationFrame(draw);
}
draw();

const species=[
    "ìˆ˜ë‹¬","ë…ìˆ˜ë¦¬","ê°€ì‹œì—°ê½ƒ","í°ê³ ë‹ˆ","ì‚µ","ë…¸ë‘ë¶€ë¦¬ì €ì–´ìƒˆ",
    "í°ê¸°ëŸ¬ê¸°","ì¡°ë¡±ì´","ì°¸ìˆ˜ë¦¬","ê·€ì´ë¹¨ëŒ€ì¹­ì´","ìˆ˜ë¦¬ë¶€ì—‰ì´","ëœ¸ë¶€ê¸°"
];
let recentNames=[];

function createFloatingName(x,y){
    for(const p of recentNames){
        if(Math.hypot(x-p.x,y-p.y)<130) return;
    }
    recentNames.push({x,y});
    if(recentNames.length>6) recentNames.shift();

    const el=document.createElement("div");
    el.className="name";
    el.textContent=species[Math.floor(Math.random()*species.length)];
    el.style.left=x+"px";
    el.style.top=y+"px";
    document.body.appendChild(el);
    requestAnimationFrame(()=>el.classList.add("show"));

    const dx=(Math.random()-0.5)*90, dy=(Math.random()-0.5)*90;

    el.animate(
        [
            {opacity:1,transform:"translate(-50%,-50%) scale(1)"},
            {opacity:0,transform:`translate(${dx}px,${dy}px) scale(1.15)`}
        ],
        {duration:4000,easing:"ease-out"}
    );

    setTimeout(()=>el.remove(),4000);
}

function scheduleCreatureFade(){
    creatures.forEach((el, index) => {
        setInterval(() => {

            if (el.classList.contains("alreadyClicked")) {
                el.classList.add("gone");
                return;
            }
            el.classList.toggle("hide");

        }, 3000 + index * 400);
    });
}



function startStatsIntro(){
    const statsIntro=document.getElementById('statsIntro');
    const statsTitle=document.getElementById('statsTitle');
    const statsTable=document.getElementById('statsTable');
    const counters=document.querySelectorAll('.counter');

    setTimeout(()=>statsTitle.classList.add('show'),700);
    setTimeout(()=>statsTable.classList.add('show'),1800);
    
    setTimeout(()=>{
        counters.forEach((el,i)=>{
            setTimeout(()=>{
                el.classList.add('show');
                animateCounter(el);
            },i*600);
        });
    },2400);
    
    setTimeout(()=>{
        statsIntro.classList.add('hide');
        triggerFlashAndIntro();
    },9000);
}

function animateCounter(el){
    const target=parseFloat(el.dataset.val);
    let current=0;
    const step=target/55;

    const id=setInterval(()=>{
        current+=step;
        if(current>=target){
            current=target;
            clearInterval(id);
            setTimeout(()=>el.classList.add('drop'),150);
            setTimeout(()=>el.classList.add('red'),400);
        }
        el.textContent=(target%1===0)?Math.floor(current):current.toFixed(1);
    },35);
}

function triggerFlashAndIntro(){
    const flash=document.getElementById('alertFlash');
    let count = 0;
    const flashLoop = setInterval(()=>{
        flash.classList.toggle('show');
        count++;
        if(count >= 10){
            clearInterval(flashLoop);
            flash.classList.remove('show');
            startMainIntro();
        }
    },120);
}

function startMainIntro(){
    autoRippleInterval = setInterval(autoRipples, 700);

    const intro    = document.getElementById('intro');
    const subtitle = document.getElementById('subtitle');
    const titleEl  = document.getElementById('title');
    const mainTitle = document.getElementById('mainTitle');
    const enterBtn  = document.getElementById('enterBtn');

    intro.classList.add('show');

    const warning = "ì§€ê¸ˆ ì´ ìˆœê°„ì—ë„\ní•œ ê³³ì˜ ìŠµì§€ê°€ ë˜ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.\nê·¸ë¦¬ê³ â€¦ ì´ê³³ ë˜í•œ ì–¸ì œ ì‚¬ë¼ì§ˆì§€ëŠ” ëª¨ë¦…ë‹ˆë‹¤.";
    let i = 0;

    (function typeWarning(){
        subtitle.classList.add('show');
        if (i < warning.length){
            subtitle.textContent += warning[i++];
            setTimeout(typeWarning, 70);
        } else {
            startTitle();
        }
    })();

    function startTitle(){
        const t = "ê¸°ì–µìœ¼ë¡œ ê¹¨ì–´ë‚˜ëŠ” ìŠµì§€,";
        let j = 0;

        (function typeT(){
            titleEl.classList.add('show');
            if (j < t.length){
                titleEl.textContent += t[j++];
                setTimeout(typeT, 120);
            } else {
                setTimeout(()=>{
                    mainTitle.classList.add('show');
                    allowNames = true;
                }, 700);
                setTimeout(()=>enterBtn.classList.add('show'), 2000);
            }
        })();
    }
}

function goNext(){

    /* ğŸ”“ afterSound ì˜¤ë””ì˜¤ unlock (ENTER í´ë¦­ ì‹œ) */
    const afterSound = document.getElementById("afterSound");
    afterSound.volume = 0;
    afterSound.play().then(() => {
        afterSound.pause();
        afterSound.currentTime = 0;
    });

    clearInterval(autoRippleInterval);

    clearInterval(autoRippleInterval);
    const bg=document.getElementById('bg');
    const intro=document.getElementById('intro');
    const btn=document.getElementById('enterBtn');
    document.getElementById("clickGuide").style.opacity = 1;
    document.getElementById("progressCounter").style.opacity = 1; 


    intro.classList.add('fade-out');
    btn.classList.add('fade-out');
    creatures.forEach(el=>el.classList.remove('gone'));
    scheduleCreatureFade();
    increaseVolume();

    setTimeout(()=>bg.classList.add('next'),1500);

    const guide = document.getElementById("mouseGuide");
    guide.classList.add("show");
    setTimeout(()=>{
        guide.classList.add("hide");
    },5000);
    
    allowNames = false;
}

document.getElementById('enterBtn').addEventListener('click', goNext);
window.addEventListener('keydown', e=>{
    if(e.key==="Enter") goNext();
});


const info = {
    creature1:{
        name:"ê°€ì‹œì—°ê½ƒ",
        desc:"* ì—°ëª»ì— ìë¼ëŠ” í•œí•´ì‚´ì´ ìˆ˜ìƒì‹ë¬¼.\n* ìê³¼ ê½ƒì¤„ê¸°ì— ê°€ì‹œ.\n* ì—¬ë¦„ì— ìì£¼ìƒ‰ ê½ƒ.\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ IIê¸‰\n* ë¶„í¬: í•œêµ­ ì¤‘ë‚¨ë¶€, ì¤‘êµ­, ì¼ë³¸"
    },
    creature2:{
        name:"ëœ¸ë¶€ê¸°",
        desc:"* ë…¼ê³¼ ìŠµì§€ì— ì‚¬ëŠ” ì—¬ë¦„ì² ìƒˆ\n* ì§™ì€ ê¹ƒí„¸ê³¼ ë…¸ë€ ë¶€ë¦¬\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ IIê¸‰\n* ë¶„í¬: í•œë°˜ë„Â·ì¼ë³¸Â·ë™ë‚¨ì•„"
    },
    creature3:{
        name:"í°ê³ ë‹ˆ",
        desc:"* ê²¨ìš¸ì² ìƒˆ, í° ë°±ìƒ‰ ê³ ë‹ˆ\n* ëª©ì„ ê³§ê²Œ ì„¸ìš°ê³  í—¤ì—„ì¹¨\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ IIê¸‰\n* ë¶„í¬: ì‹œë² ë¦¬ì•„â€“í•œêµ­â€“ì¼ë³¸"
    },
    creature4:{
        name:"ì‚µ",
        desc:"* ì¤‘í˜• ë§¹ìˆ˜, ì•¼í–‰ì„±\n* ì„¤ì¹˜ë¥˜Â·ì¡°ë¥˜ ì‚¬ëƒ¥\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ IIê¸‰\n* ë¶„í¬: ì „êµ­, ëŸ¬ì‹œì•„Â·ì¤‘êµ­Â·ì‹œë² ë¦¬ì•„"
    },
    creature5:{
        name:"ë…¸ë‘ë¶€ë¦¬ì €ì–´ìƒˆ",
        desc:"* ì£¼ê±±ëª¨ì–‘ ë¶€ë¦¬, í° ëª¸\n* ê²¨ìš¸ì² ìƒˆ\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ IIê¸‰\n* ë¶„í¬: ì„œí•´ì•ˆ, ì œì£¼, ë™ì•„ì‹œì•„"
    },
    creature6:{
        name:"ì¡°ë¡±ì´",
        desc:"* ì‘ì€ ë§¹ê¸ˆë¥˜, ìˆ²ì† ë²ˆì‹\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ IIê¸‰\n* ë¶„í¬: ì „êµ­"
    },
    creature7:{
        name:"ìˆ˜ë¦¬ë¶€ì—‰ì´",
        desc:"* í•œêµ­ ìµœëŒ€ ì˜¬ë¹¼ë¯¸\n* ë‹¨ë… ìƒí™œÂ·ì•¼í–‰ì„±\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ IIê¸‰\n* ë¶„í¬: ì „êµ­, ìœ ë¼ì‹œì•„"
    },
    creature8:{
        name:"ë…ìˆ˜ë¦¬",
        desc:"* í° ì²´êµ¬ì˜ ê²¨ìš¸ì²  ë§¹ê¸ˆë¥˜\n* ì‚¬ì²´ë¥¼ ë¨¹ëŠ” ì²­ì†Œë™ë¬¼ ì—­í• \n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ IIê¸‰\n* ë¶„í¬: í•œêµ­Â·ëª½ê³¨Â·ì¤‘ì•™ì•„ì‹œì•„"
    },
    creature9:{
        name:"ì°¸ìˆ˜ë¦¬",
        desc:"* ê±°ëŒ€í•œ ë§¹ê¸ˆë¥˜\n* í° ê¼¬ë¦¬+ë…¸ë€ ë¶€ë¦¬ íŠ¹ì§•\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ Iê¸‰\n* ë¶„í¬: ë™ë¶ì•„ì‹œì•„"
    },
    creature10:{
        name:"ìˆ˜ë‹¬",
        desc:"* í•˜ì²œÂ·í˜¸ìˆ˜ ì„œì‹ í¬ìœ ë¥˜\n* ë¬¼ê°ˆí€´ê°€ ìˆì–´ ìˆ˜ì˜ íŠ¹í™”\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ Iê¸‰\n* ë¶„í¬: ì „êµ­"
    },
    creature11:{
        name:"ê·€ì´ë¹¨ëŒ€ì¹­ì´",
        desc:"* í•œêµ­ ìµœëŒ€ ë‹´ìˆ˜ íŒ¨ë¥˜\n* ì§„ì£¼ì¸µì´ í˜•ì„±ë˜ëŠ” ì¡°ê°œ\n* ë©¸ì¢…ìœ„ê¸° ì•¼ìƒìƒë¬¼ Iê¸‰\n* ë¶„í¬: ì „êµ­"
    }
};

const overlays = {
    creature1: document.getElementById("overlay-creature1"),
    creature2: document.getElementById("overlay-creature2"),
    creature3: document.getElementById("overlay-creature3"),
    creature4: document.getElementById("overlay-creature4"),
    creature5: document.getElementById("overlay-creature5"),
    creature6: document.getElementById("overlay-creature6"),
    creature7: document.getElementById("overlay-creature7"),
    creature8: document.getElementById("overlay-creature8"),
    creature9: document.getElementById("overlay-creature9"),
    creature10: document.getElementById("overlay-creature10"),
    creature11: document.getElementById("overlay-creature11"),
};

const infoBox = document.getElementById("infoBox");
const boxTitle = infoBox.querySelector(".box-title");
const boxImg = infoBox.querySelector(".box-img");
const boxDesc = infoBox.querySelector(".box-desc");
let prevBoxElement = null;
let lines = [];
let activePoints=[];


function showOverlay(creature){
    const overlay = overlays[creature.id];
    overlay.classList.add("show");
    const rect = creature.getBoundingClientRect();
    overlay.style.left = rect.left + "px";
    overlay.style.top = rect.top + "px";
    overlay.style.width = rect.width + "px";
    overlay.style.height = rect.height + "px";
    creature.classList.add("gone");
}


creatures.forEach(c => {

    c.addEventListener("click", (e) => {

        if (c.classList.contains("alreadyClicked")) return;
        c.classList.add("alreadyClicked");

        awakenedCount++;
        document.getElementById("progressCounter").textContent =
        awakenedCount + " / " + totalCreatures;
        updateGuideMessage();


        playClickSound();
        touchSound.currentTime = 0;
        touchSound.play();

        const rect = c.getBoundingClientRect();
        const data = info[c.id];
        const overlay = overlays[c.id];
        const newBox = infoBox.cloneNode(true);
        document.body.appendChild(newBox);

        newBox.style.display = "block";
        newBox.style.visibility = "hidden";

        newBox.querySelector(".box-title").textContent = data.name;
        newBox.querySelector(".box-img").src = c.src;
        newBox.querySelector(".box-desc").textContent = data.desc;

        const bw = newBox.offsetWidth;
        const bh = newBox.offsetHeight;

        let left = e.clientX;
        let top = e.clientY;
        const PADDING = 20;

        if (left < PADDING) left = PADDING;
        if (left + bw > window.innerWidth - PADDING)
            left = window.innerWidth - bw - PADDING;

        if (top < PADDING) top = PADDING;
        if (top + bh > window.innerHeight - PADDING)
            top = window.innerHeight - bh - PADDING;

        newBox.style.left = left + "px";
        newBox.style.top = top + "px";
        newBox.style.visibility = "visible";

        newBox.querySelector(".infoBox-close").addEventListener("click", () => {
            playClickSound();
            newBox.remove();

            overlay.classList.add("show");
            overlay.style.left = rect.left + "px";
            overlay.style.top = rect.top + "px";
            overlay.style.width = rect.width + "px";
            overlay.style.height = rect.height + "px";

            overlayShownCount++;
            checkAllAwakened();
        });
    });
});
    function checkAllAwakened() {
    if (awakenedCount === totalCreatures && overlayShownCount === totalCreatures) {

        const fadeBlack = document.getElementById("fullFadeBlack");
        const fadeAfter = document.getElementById("fullFadeAfter");
        const bg = document.getElementById("bg");

        fadeBlack.style.transition = "opacity 0.25s ease-out";
        fadeBlack.style.opacity = 1;

setTimeout(() => {
const afterSound = document.getElementById("afterSound");

afterSound.currentTime = 0;
afterSound.volume = 0;
afterSound.play();

let fadeInterval = setInterval(() => {
    bgm.volume = Math.max(0, bgm.volume - 0.025);
    afterSound.volume = Math.min(1, afterSound.volume + 0.025);
    if (bgm.volume === 0 && afterSound.volume === 1) {
        clearInterval(fadeInterval);
        bgm.pause();
    }
}, 120);


    bg.style.background =
    "linear-gradient(rgba(5,8,6,0.3),rgba(0,0,0,0.6)), url('after.jpg') center/cover no-repeat";

    document.querySelectorAll('.creature, .shape-overlay').forEach(el => {
        el.style.transition = "opacity 0.25s ease-out";
        el.style.opacity = 0;
    });

    fadeAfter.style.transition = "opacity 3s ease-out";
    fadeAfter.style.opacity = 1;

    fadeBlack.style.transition = "opacity 1.2s ease-out";
    fadeBlack.style.opacity = 0;

    setTimeout(() => {
        fadeAfter.style.opacity = 0;
    }, 3000);

}, 400);


        setTimeout(showEnding, 3800);
    }
}





function showEnding(){
    const textBox = document.getElementById("endingTextContainer");
    const line1   = document.getElementById("endingLine1");
    const line2   = document.getElementById("endingLine2");

    const end   = document.getElementById("endingScreen");
    const msg   = document.getElementById("endingMessage");
    const title = document.getElementById("endingTitle");
    const cards = document.getElementById("endingCards");

    textBox.style.opacity = 1;

    setTimeout(() => {
        line1.style.opacity = 1;
    }, 300);

    setTimeout(() => {
        line2.style.opacity = 1; 
    }, 1700);

    setTimeout(() => {
        line1.style.opacity = 0;
        line2.style.opacity = 0;
        textBox.style.opacity = 0;
    }, 4800); 

    setTimeout(() => {
        end.style.display = "flex";

        setTimeout(()=> {
            msg.style.opacity = 1;
        }, 300);

        setTimeout(()=> {
            msg.style.opacity = 0;
        }, 2800);

        setTimeout(()=> {
            title.style.opacity = 1;
        }, 3600);
        setTimeout(()=> {
            document.getElementById("endingSub");
            endingSub.style.opacity = 1;
        }, 8200);


        setTimeout(()=>{
            cards.style.opacity = 1;
            cards.style.transform = "translateY(0)";
        }, 4800);
        const cardContainer = document.getElementById("endingCards");
        const nextStep = document.getElementById("nextStepScreen");

        cardContainer.addEventListener("scroll", () => {
            const maxScroll = cardContainer.scrollWidth - cardContainer.clientWidth;
            
            if (cardContainer.scrollLeft >= maxScroll - 10) {
                nextStep.style.display = "block";
                nextStep.style.opacity = 0;

                setTimeout(() => {
                    nextStep.style.transition = "opacity 1.5s ease";
                    nextStep.style.opacity = 1;

                    nextStep.innerHTML = `
                        <div style="
                            position:absolute;
                            top:50%;
                            left:50%;
                            transform:translate(-50%, -50%);
                            text-align:center;
                            width:100%;
                        ">
                            <h1 style="
                                font-family:'Shilla';
                                font-size:2.6rem;
                                margin-bottom:20px;
                            ">
                                ë‹¹ì‹ ì´ ê¸°ì–µí–ˆê¸°ì—, ì´ê³³ì€ ì˜¤ëŠ˜ë„ ìˆ¨ì„ ì‰½ë‹ˆë‹¤.
                            </h1>

                            <p style="
                                font-size:1.3rem;
                                color:#cccccc;
                                line-height:1.8;
                                margin-top:20px;
                            ">
                                ì‘ì€ ê´€ì‹¬ì´ ë˜ í•˜ë‚˜ì˜ ìƒëª…ì„ ì§€ì¼œëƒ…ë‹ˆë‹¤.<br>
                            </p>
                        </div>
                    `;
                }, 200);
            }
        });

    }, 5200);
}

startStatsIntro();
</script>
<div id="progressCounter" style="
    position:fixed;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    font-family:'Shilla';
    font-size:2rem;
    color:#a8ffcd;
    z-index:999999;
    opacity:0;           
    transition:opacity .5s ease;">
    0 / 11
</div>
    <div id="clickGuide" style="
        position:fixed;
        top:70px;
        left:50%;
        transform:translateX(-50%);
        font-family:'Shilla';
        font-size:1.3rem;
        color:#ffffffaa;
        z-index:999999;
        opacity:0;
        transition:opacity 1s ease;">
        ìƒë¬¼ì„ í´ë¦­í•´ë³´ì„¸ìš”. ê° ìƒë¬¼ì˜ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </div>
    <div id="endingTextContainer" style="
        position:fixed;
        inset:0;
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        text-align:center;
        width:100%;
        color:white;
        z-index:9999999;
        opacity:0;
        pointer-events:none;
        font-family:'Shilla';
        transition:opacity 1.8s ease;
    ">
        <div id="endingLine1" style="
        font-size:1.8rem;
        line-height:1.6;
        margin-bottom:24px;
        opacity:0;
        transition:opacity 1.8s ease;
        white-space:pre-line;
">
    í™”í¬ì²œ ìŠµì§€ëŠ” ì „ì²´ ë©´ì ì˜ 70% ì´ìƒì´ ìì—°ìŠµì§€ë¡œ ë‚¨ì•„ ìˆëŠ” êµ­ë‚´ í¬ê·€ ìƒíƒœì§€ì—­ìœ¼ë¡œ,
    ë©¸ì¢…ìœ„ê¸°ì¢… 20ì—¬ ì¢…ê³¼ 600ì¢… ì´ìƒì˜ ìƒë¬¼ì´ ì„œì‹í•˜ëŠ” ìƒë¬¼ë‹¤ì–‘ì„±ì˜ í•µì‹¬ ì§€ëŒ€ì…ë‹ˆë‹¤.
</div>


        <div id="endingLine2" style="
            font-size:2.4rem;
            opacity:0;
            transition:opacity 2s ease;
        ">
            ì‚¬ë¼ì ¸ê°€ëŠ” ìƒë¬¼ë“¤ì„ ê¸°ì–µí•´ì£¼ì„¸ìš”.
        </div>
    </div>
    <div id="endingScreen" style="
    display:none; position:fixed; inset:0; background:#000; 
    z-index:9999999; justify-content:center; align-items:center; 
    flex-direction:column;">

    <h2 id="endingTitle" style="
        font-family:'Shilla';
        font-size:2rem;
        color:white;
        margin-bottom:30px;
        opacity:0;
        transition:opacity 1s ease;">
        í™”í¬ì²œ ìŠµì§€ì— ì‚¬ëŠ” ë©¸ì¢…ìœ„ê¸° ìƒë¬¼ë“¤
    </h2>

    <div id="endingMessage" style="
        font-family:'Shilla'; font-size:3rem; color:white;
        opacity:0; transition:opacity 1.5s ease; margin-bottom:40px;">
        ì‚¬ë¼ì ¸ê°€ëŠ” ìƒë¬¼ë“¤ì„ ê¸°ì–µí•´ì£¼ì„¸ìš”.
    </div>

    <div id="endingSub" style="
        font-family:'Noto Sans KR';
        color:#ccc;
        opacity:0;
        font-size:1.2rem;
        margin-top:-6px;
        max-width:800px;
        text-align:center;
        line-height:1.6;
        transition:opacity 1.5s ease;">
        ìš°ë¦¬ê°€ ë” ì´ìƒ ë³´ì§€ ëª»í• ì§€ë„ ëª¨ë¥¼ ìƒë¬¼ë“¤ì…ë‹ˆë‹¤.<br>
        ì´ë“¤ì„ ê¸°ì–µí•˜ê³ , ê´€ì‹¬ì„ ê°€ì ¸ì£¼ì„¸ìš”.
    </div>
        
        <div id="endingCards">
            <div class="card">
                <div class="imgWrap"><img src="ll.png" alt=""></div>
                <h3>ë‚¨ìƒì´</h3>
                <p>ê³ ìš”í•œ ë¬¼ê°€ë¥¼ ì§€í‚¤ëŠ” í•œêµ­ í† ì¢… ê±°ë¶</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="mm.png" alt=""></div>
                <h3>ìƒˆë§¤</h3>
                <p>ì¬ë¹ ë¥´ê²Œ ìˆ²ì„ ëˆ„ë¹„ëŠ” ë¯¼ì²©í•œ ë§¹ê¸ˆë¥˜</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="nn.png" alt=""></div>
                <h3>ì†”ê°œ</h3>
                <p>ë„“ì€ í•˜ëŠ˜ì„ ì„ íšŒí•˜ëŠ” ê°ˆìƒ‰ ë§¹ê¸ˆ</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="oo.png" alt=""></div>
                <h3>ì°¸ë§¤</h3>
                <p>ìˆ² ì†ì„ ì§€ë°°í•˜ëŠ” ê°•ë ¥í•œ ì‚¬ëƒ¥ê¾¼</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="pp.png" alt=""></div>
                <h3>ë§¤</h3>
                <p>í•˜ëŠ˜ì„ ê°€ë¥´ëŠ” ì„¸ê³„ì—ì„œ ê°€ì¥ ë¹ ë¥¸ ë§¹ê¸ˆ</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="qq.png" alt=""></div>
                <h3>í™©ìƒˆ</h3>
                <p>ë‹¤ì‹œ ëŒì•„ì˜¨ í¬ê·€í•œ í°ìƒ‰ ì² ìƒˆ</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="rr.png" alt=""></div>
                <h3>ì°¸ìˆ˜ë¦¬</h3>
                <p>ê²¨ìš¸ í•˜ëŠ˜ì„ ì¥ì•…í•˜ëŠ” ê±°ëŒ€í•œ ë§¹ê¸ˆë¥˜</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="ss.png" alt=""></div>
                <h3>ìƒˆí˜¸ë¦¬ê¸°</h3>
                <p>ìˆœì‹ê°„ì— ë¨¹ì´ë¥¼ ë‚šëŠ” ì‘ì€ ì‚¬ëƒ¥ê¾¼</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="tt.png" alt=""></div>
                <h3>ì•Œë½ê°œêµ¬ë¦¬ë§¤</h3>
                <p>ìŠµì§€ë¥¼ ìŠ¤ì¹˜ë“¯ ë‚ ì•„ê°€ëŠ” í¬ê·€ ë§¹ê¸ˆ</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="uu.png" alt=""></div>
                <h3>í°ë§ë˜¥ê°€ë¦¬</h3>
                <p>í‰ì•¼ ìœ„ë¥¼ ì„ íšŒí•˜ëŠ” ëŒ€í˜• ë§¹ê¸ˆë¥˜</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="vv.png" alt=""></div>
                <h3>í°ëª©ë¬¼ë–¼ìƒˆ</h3>
                <p>ëª¨ë˜ë°­ì—ì„œ ë›°ë…¸ëŠ” ì‘ì€ ë¬¼ê°€ ìƒˆ</p>
            </div>
            <div class="card">
                <div class="imgWrap"><img src="ww.png" alt=""></div>
                <h3>ë¶‰ì€ë°°ìƒˆë§¤</h3>
                <p>ë¶‰ì€ ë°°ë¹›ì´ ë‹ë³´ì´ëŠ” ìš°ì•„í•œ ë§¹ê¸ˆ</p>
            </div>
        </div>
        <div id="nextStepScreen" style="
    display:none;
    position:fixed;
    inset:0;
    background:#000;
    z-index:99999999;
    padding:80px 60px;
    color:white;
    font-family:'Noto Sans KR';
    overflow-y:auto;
"></div>

<div id="flashBlack" style="
    position:fixed;
    inset:0;
    background:#000;
    opacity:0;
    pointer-events:none;
    z-index:999999999;"></div>

<div id="flashReveal" style="
    position:fixed;
    inset:0;
    background:url('after.jpg') center/cover no-repeat;
    opacity:0;
    pointer-events:none;
    z-index:999999998;"></div>

<div id="fullFadeBlack"></div>
<div id="fullFadeAfter"></div>

</div>
    </div> </body>
</html>